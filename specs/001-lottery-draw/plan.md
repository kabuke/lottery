# 實作計畫: 抽獎活動

## 1. 專案設定

- **任務 1.1:** 初始化一個新的 由golang version 1.24.1 + Gin + HTMX組成Web 應用程式專案，最終要能編譯成一個單一的執行檔在linux上執行。
- **任務 1.2:** 專案結構設定，包含元件、樣式和邏輯的資料夾如下所示
                lottery/
                ├── cmd/
                │   └── main.go  // 入口點
                ├── internal/
                │   ├── handlers/  // Gin 處理器（抽獎邏輯）
                │   ├── models/    // 資料模型（獎項、參與者）
                │   ├── services/  // 業務邏輯（CSV 解析、抽獎演算法）
                │   └── templates/ // HTMX HTML 模板（用 html/template 或 Templ）
                ├── assets/        // 靜態檔案（CSS、JS，包括 htmx.min.js）
                ├── go.mod
                └── go.sum
- **任務 1.3:** HTMX CDN 網址 https://cdn.jsdelivr.net/npm/htmx.org/dist/
- **任務 1.4:** 為每個使用者/公司提供獨立的資料空間管理一個「租戶地圖 (map)」，其鍵 (key) 由您指定的使用者名稱和 Client IP 組成，值 (value) 則是對應的LotterySession。
               LotterySession 結構，用來存放的資料，包括：獎項、參與者、中獎結果，以及一個 LastActivity 時間戳，用來追蹤該租戶的最後活動時間。

## 2. 核心功能開發

- **任務 2.1: 獎項設定介面**
    - 開發一個表單讓使用者可以手動輸入獎項名稱和數量。
    - 實作一個區塊，用於顯示已新增的獎項列表。
    - 建立一個按鈕，觸發檔案選擇器以上傳獎項 CSV 檔案。

- **任務 2.2: 參與者設定介面**
    - 開發一個輸入欄位讓使用者設定參與者總數。
    - 建立一個按鈕，觸發檔案選擇器以上傳參與者 CSV 檔案。
    - 實作一個區塊，用於顯示已上傳的參與者資訊。

- **任務 2.3: CSV 資料處理**
    - 實作解析 CSV 檔案的邏輯，以處理獎項和參與者資料。
    - 加入錯誤處理機制，以應對格式不符的 CSV 檔案。

## 3. 抽獎流程開發

- **任務 3.1: 抽獎主要邏輯**
    - 實作核心抽獎演算法，確保每位參與者只能中獎一次（額外獎項除外）。
    - 建立一個狀態來管理剩餘的獎項和未中獎的參與者。

- **任務 3.2: 抽獎介面**
    - 設計一個抽獎主畫面，顯示目前的獎項和一個「開始抽獎」按鈕。
    - 建立一個動畫或視覺效果來展示抽獎過程。
    - 抽獎結束後，顯示中獎者資訊。

- **任務 3.3: 額外獎項邏輯**
    - 實作一個選項，讓使用者在抽額外獎項時，能選擇抽獎範圍（全體或未中獎者）。

## 4. 結果顯示與匯出

- **任務 4.1: 即時結果顯示**
    - 開發一個元件，用於即時顯示已抽出的獎項和對應的中獎者列表。

- **任務 4.2: 結果匯出**
    - 建立一個「下載結果」按鈕。
    - 實作將最終抽獎結果轉換為 CSV 格式並下載的邏輯。

## 5. 測試與部署

- **任務 5.1: 單元測試**
    - 為核心邏輯（如 CSV 解析、抽獎演算法）撰寫單元測試。
- **任務 5.2: 整合測試**
    - 測試各個元件之間的互動是否正常。
- **任務 5.3: 使用者驗收測試**
    - 進行端對端測試，確保所有功能符合規格。
- **任務 5.4: 部署**
    - 將應用程式部署到指定的平台。
