# 任務列表: 抽獎活動

## 1. 專案設定

- [x] **任務 1.1:** 建立符合 `spec.md` 規範的專案目錄結構。
- [x] **任務 1.2:** 設定 Gin 路由框架與 `html/template` 引擎。
- [x] **任務 1.3:** 引入 HTMX 函式庫至前端樣板。
- [x] **任務 1.4:** 建立基本的資料模型 (structs) 來表示獎項、參與者與抽獎結果。

## 2. 獎項設定 (對應 Spec 2.1)

- [x] **任務 2.1.1 (手動新增):** 開發手動新增獎項的 HTML 表單。
- [x] **任務 2.1.2 (手動新增):** 建立 `POST /prizes` 端點來處理表單提交，並透過 HTMX 更新獎項列表。
- [x] **任務 2.1.3 (CSV 上傳):** 開發上傳獎項 CSV 的 HTML 表單。
- [x] **任務 2.1.4 (CSV 上傳):** 建立 `POST /upload-prizes-csv` 端點來解析 CSV 檔案，處理 4 個欄位，包含 drawFromAll 標記，並透過 HTMX 更新獎項列表。
- [x] **任務 2.1.5 (CSV 錯誤處理):** 在後端加入對 CSV 格式錯誤的處理與驗證邏輯。
- [x] **任務 2.1.6 (列表顯示):** 建立一個可重用的 HTML 樣板，用於顯示獎項列表。
- [x] **任務 2.1.7 (追加獎項):** 在獎項資料模型中加入一個欄位（例如 `IsExtra`），並在 UI 上提供相應的設定選項。

## 3. 參與者設定 (對應 Spec 2.2)

- [x] **任務 3.1.1 (手動新增):** 開發手動新增參與者的 HTML 表單。
- [x] **任務 3.1.2 (手動新增):** 建立 `POST /participants` 端點來處理表單提交，並透過 HTMX 更新參與者列表。
- [x] **任務 3.1.3 (CSV 上傳):** 開發上傳參與者 CSV 的 HTML 表單。
- [x] **任務 3.1.4 (CSV 上傳):** 建立 `POST /upload-participants-csv` 端點來解析 CSV 檔案，並透過 HTMX 更新參與者列表。
- [x] **任務 3.1.5 (列表顯示):** 建立一個可重用的 HTML 樣板，用於顯示參與者列表。

## 4. 抽獎流程 (對應 Spec 2.3)

- [x] **任務 4.1 (核心邏輯):** 在 `services` 層實作核心抽獎演算法，確保參與者不會重複中獎。
- [x] **任務 4.2 (核心邏輯):** 實作狀態管理，以追蹤剩餘獎項和未中獎的參與者。
- [x] **任務 4.3 (抽獎介面):** 開發抽獎主介面，包含獎項下拉選單和「開始抽獎」按鈕。
- [x] **任務 4.4 (抽獎介面):** 建立 `POST /draw` 端點，執行抽獎並透過 HTMX 回傳包含中獎者資訊的 HTML 片段。
- [x] **任務 4.5 (額外獎項):** 在抽獎邏輯中，根據獎項的 `IsExtra` 標記和使用者選擇，實現從「全體」或「未中獎者」中抽取的不同邏輯。

## 5. 結果顯示與匯出 (對應 Spec 2.4)

- [x] **任務 5.1 (即時結果):** 在抽獎介面上建立一個區域，用於透過 HTMX 動態插入和顯示每一筆中獎紀錄。
- [x] **任務 5.2 (結果匯出):** 開發一個「下載抽獎結果」的按鈕或連結。
- [x] **任務 5.3 (結果匯出):** 建立 `GET /export-results-csv` 端點，該端點會產生並回傳符合 `spec.md` 格式的 CSV 檔案。

## 6. 測試與部署

- [x] **任務 6.1 (單元測試):** 為核心業務邏輯（如抽獎演算法、CSV 解析）撰寫單元測試。
- [ ] **任務 6.2 (整合測試):** 測試 Gin 處理器與後端服務之間的互動。
- [x] **任務 6.3 (建置):** 建立一個 `build.sh` 或 Makefile，用於將應用程式編譯成單一的 Linux 執行檔。
- [ ] **任務 6.4 (部署):** 將編譯後的執行檔部署到目標伺服器。